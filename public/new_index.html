<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>College Notes - Colorful V2</title>
    <link rel="stylesheet" href="new_style.css">
</head>
<body>
    <nav class="sidebar">
        <div class="logo">
            <h2>College Project</h2>
        </div>
        <ul>
            <li><a href="#home">Home</a></li>
            <li><a href="#notes">Notes</a></li>
            <li><a href="#upload">Upload</a></li>
        </ul>
    </nav>

    <main class="content">
        <section id="home" class="hero">
            <h1>Welcome to the Notes Portal</h1>
            <p>A vibrant place to share and find knowledge.</p>
        </section>

        <section id="upload" class="admin-panel">
            <h2>Upload New Note</h2>
            <div class="container">
                <form id="uploadForm">
                    <input type="password" id="password" name="password" placeholder="Enter Admin Password" required>
                    <input type="file" id="note" name="note" accept=".pdf" required>
                    <button type="submit">Upload Note</button>
                </form>
            </div>
        </section>

        <section id="notes" class="notes-section">
            <h2>Available Notes</h2>
            <div id="notes-grid" class="notes-grid">
                <!-- Notes will be injected here -->
                <p>Loading notes...</p>
            </div>
        </section>
    </main>

    <script>
        const notesGrid = document.getElementById('notes-grid');
        const uploadForm = document.getElementById('uploadForm');

        function renderNotes(notes) {
            notesGrid.innerHTML = '';
            if (notes.length === 0) {
                notesGrid.innerHTML = '<p>No notes available.</p>';
                return;
            }
            notes.forEach(note => {
                const noteElement = document.createElement('div');
                noteElement.classList.add('note-card');

                const noteTitle = document.createElement('h3');
                noteTitle.textContent = note.title;

                const downloadLink = document.createElement('a');
                downloadLink.classList.add('download-btn');
                downloadLink.href = `/notes/${note.fileName}`;
                downloadLink.textContent = 'Download PDF';
                downloadLink.download = note.fileName;

                noteElement.appendChild(noteTitle);
                noteElement.appendChild(downloadLink);

                notesGrid.appendChild(noteElement);
            });
        }

        function fetchNotes() {
            fetch('/api/notes')
                .then(response => response.json())
                .then(notes => renderNotes(notes))
                .catch(error => console.error('Error fetching notes:', error));
        }

        uploadForm.addEventListener('submit', (event) => {
            event.preventDefault();
            const formData = new FormData(uploadForm);
            fetch('/api/upload', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) return response.text();
                throw new Error('Upload failed. Check password.');
            })
            .then(message => {
                alert(message);
                uploadForm.reset();
                fetchNotes();
            })
            .catch(error => alert(error.message));
        });

        // Initial fetch
        fetchNotes();
    </script>
</body>
</html>